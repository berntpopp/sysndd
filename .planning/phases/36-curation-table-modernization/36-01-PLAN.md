---
phase: 36-curation-table-modernization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/src/views/curate/ApproveReview.vue
  - app/src/views/curate/ApproveStatus.vue
autonomous: true

must_haves:
  truths:
    - "Curator can filter ApproveReview table by category (stoplight)"
    - "Curator can filter ApproveReview table by user name"
    - "Curator can filter ApproveReview table by date range"
    - "Curator can filter ApproveStatus table by category (stoplight)"
    - "Curator can filter ApproveStatus table by user name"
    - "Curator can filter ApproveStatus table by date range"
    - "Both tables use standardized pagination [10, 25, 50, 100]"
  artifacts:
    - path: "app/src/views/curate/ApproveReview.vue"
      provides: "Column filters for ApproveReview"
      contains: "categoryFilter"
    - path: "app/src/views/curate/ApproveStatus.vue"
      provides: "Column filters for ApproveStatus"
      contains: "categoryFilter"
  key_links:
    - from: "ApproveReview.vue"
      to: "BTable :items"
      via: "computed columnFilteredItems"
      pattern: "columnFilteredItems"
    - from: "ApproveStatus.vue"
      to: "BTable :items"
      via: "computed columnFilteredItems"
      pattern: "columnFilteredItems"
---

<objective>
Add column filters (category, user, date range) to ApproveReview and ApproveStatus tables and standardize pagination options.

Purpose: Enable curators to filter large review/status tables by specific columns without scrolling through all rows (TBL-01, TBL-02, TBL-03).

Output: ApproveReview and ApproveStatus views with column filter row and standardized [10, 25, 50, 100] pagination.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/36-curation-table-modernization/36-RESEARCH.md

# Source files to modify
@app/src/views/curate/ApproveReview.vue
@app/src/views/curate/ApproveStatus.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add column filters to ApproveReview.vue</name>
  <files>app/src/views/curate/ApproveReview.vue</files>
  <action>
Add column filters (category, user, date range) to ApproveReview.vue:

1. Add filter state variables in data():
```javascript
categoryFilter: null,
userFilter: null,
dateRangeStart: null,
dateRangeEnd: null,
```

2. Add computed property for category options (derive from stoplights_style keys):
```javascript
categoryOptions() {
  return Object.keys(this.stoplights_style).map(key => ({
    value: key,
    text: key
  }));
}
```

3. Add computed property `columnFilteredItems` that filters items_ReviewTable:
- Filter by active_category if categoryFilter is set
- Filter by review_user_name (case-insensitive partial match) if userFilter is set
- Filter by review_date using Date objects if dateRangeStart or dateRangeEnd are set
- Return filtered array

4. Add filter row in template AFTER the search row (line ~58), BEFORE the pagination row:
```vue
<BRow class="mb-2 px-2">
  <BCol md="3">
    <BFormGroup label="Category" label-size="sm" class="mb-0">
      <BFormSelect v-model="categoryFilter" :options="categoryOptions" size="sm">
        <template #first>
          <BFormSelectOption :value="null">All Categories</BFormSelectOption>
        </template>
      </BFormSelect>
    </BFormGroup>
  </BCol>
  <BCol md="3">
    <BFormGroup label="User" label-size="sm" class="mb-0">
      <BFormInput v-model="userFilter" type="search" placeholder="Filter by user..." size="sm" debounce="300" />
    </BFormGroup>
  </BCol>
  <BCol md="3">
    <BFormGroup label="From Date" label-size="sm" class="mb-0">
      <BFormInput v-model="dateRangeStart" type="date" size="sm" />
    </BFormGroup>
  </BCol>
  <BCol md="3">
    <BFormGroup label="To Date" label-size="sm" class="mb-0">
      <BFormInput v-model="dateRangeEnd" type="date" size="sm" />
    </BFormGroup>
  </BCol>
</BRow>
```

5. Update BTable to use `:items="columnFilteredItems"` instead of `:items="items_ReviewTable"`

6. Update pageOptions from `[10, 25, 50, 200]` to `[10, 25, 50, 100]`

7. Update onFiltered to recalculate totalRows from columnFilteredItems when global search applies:
```javascript
onFiltered(filteredItems) {
  this.totalRows = filteredItems.length;
  this.currentPage = 1;
}
```

8. Add watcher to reset currentPage when column filters change.

IMPORTANT: Keep existing :filter prop for global search (both filters work together).
  </action>
  <verify>Run `npm run lint --prefix app` passes. Visual inspection shows filter row appears above table.</verify>
  <done>ApproveReview.vue has category, user, and date range filters with standardized pagination [10, 25, 50, 100]</done>
</task>

<task type="auto">
  <name>Task 2: Add column filters to ApproveStatus.vue</name>
  <files>app/src/views/curate/ApproveStatus.vue</files>
  <action>
Add column filters (category, user, date range) to ApproveStatus.vue following the same pattern as Task 1:

1. Add filter state variables in data():
```javascript
categoryFilter: null,
userFilter: null,
dateRangeStart: null,
dateRangeEnd: null,
```

2. Add computed property for category options (derive from stoplights_style keys):
```javascript
categoryOptions() {
  return Object.keys(this.stoplights_style).map(key => ({
    value: key,
    text: key
  }));
}
```

3. Add computed property `columnFilteredItems` that filters items_StatusTable:
- Filter by category if categoryFilter is set (note: ApproveStatus has `category` field, not `active_category`)
- Filter by status_user_name (case-insensitive partial match) if userFilter is set
- Filter by status_date using Date objects if dateRangeStart or dateRangeEnd are set
- Return filtered array

4. Add filter row in template AFTER the search row (line ~56), BEFORE the pagination row:
```vue
<BRow class="mb-2 px-2">
  <BCol md="3">
    <BFormGroup label="Category" label-size="sm" class="mb-0">
      <BFormSelect v-model="categoryFilter" :options="categoryOptions" size="sm">
        <template #first>
          <BFormSelectOption :value="null">All Categories</BFormSelectOption>
        </template>
      </BFormSelect>
    </BFormGroup>
  </BCol>
  <BCol md="3">
    <BFormGroup label="User" label-size="sm" class="mb-0">
      <BFormInput v-model="userFilter" type="search" placeholder="Filter by user..." size="sm" debounce="300" />
    </BFormGroup>
  </BCol>
  <BCol md="3">
    <BFormGroup label="From Date" label-size="sm" class="mb-0">
      <BFormInput v-model="dateRangeStart" type="date" size="sm" />
    </BFormGroup>
  </BCol>
  <BCol md="3">
    <BFormGroup label="To Date" label-size="sm" class="mb-0">
      <BFormInput v-model="dateRangeEnd" type="date" size="sm" />
    </BFormGroup>
  </BCol>
</BRow>
```

5. Update BTable to use `:items="columnFilteredItems"` instead of `:items="items_StatusTable"`

6. Update pageOptions from `[10, 25, 50, 200]` to `[10, 25, 50, 100]`

7. Add watcher to reset currentPage when column filters change.

IMPORTANT: Keep existing :filter prop for global search.
  </action>
  <verify>Run `npm run lint --prefix app` passes. Visual inspection shows filter row appears above table.</verify>
  <done>ApproveStatus.vue has category, user, and date range filters with standardized pagination [10, 25, 50, 100]</done>
</task>

</tasks>

<verification>
1. `npm run lint --prefix app` passes without errors
2. ApproveReview shows filter row with Category dropdown, User input, From Date, To Date
3. ApproveStatus shows filter row with Category dropdown, User input, From Date, To Date
4. Both views show pagination options [10, 25, 50, 100]
5. Column filters work: selecting category filters rows, typing user name filters rows, date range filters rows
6. Global search still works alongside column filters
7. Pagination updates correctly when filters are applied
</verification>

<success_criteria>
- ApproveReview has column filters (category, user, date range) - TBL-01
- ApproveStatus has column filters (category, user, date range) - TBL-02
- Both views use pageOptions [10, 25, 50, 100] - TBL-03
- Existing search functionality preserved
- No lint errors
</success_criteria>

<output>
After completion, create `.planning/phases/36-curation-table-modernization/36-01-SUMMARY.md`
</output>
