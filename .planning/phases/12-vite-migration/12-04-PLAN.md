---
phase: 12-vite-migration
plan: 04
type: execute
wave: 2
depends_on: [12-01]
files_modified:
  - app/src/router/routes.js
  - app/src/global-components.js
  - app/src/main.js
  - app/src/App.vue
  - app/src/components/**/*.vue
  - app/src/views/**/*.vue
autonomous: true

must_haves:
  truths:
    - "All component imports include .vue extension"
    - "No webpack magic comments remain in codebase"
    - "Dynamic imports use standard ES import() syntax"
  artifacts:
    - path: "app/src/router/routes.js"
      provides: "Route definitions with Vite-compatible imports"
      min_lines: 600
    - path: "app/src/global-components.js"
      provides: "Global component definitions with clean imports"
  key_links:
    - from: "app/src/router/routes.js"
      to: "app/src/views/*.vue"
      via: "dynamic import"
      pattern: "import\\("
---

<objective>
Update all import statements to be Vite-compatible: add .vue extensions and remove webpack-specific magic comments.

Purpose: Vite requires explicit .vue extensions (native ES modules) and doesn't support webpack magic comments for chunk naming.
Output: All imports Vite-compatible, code splitting works via Vite's automatic chunk detection.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/12-vite-migration/12-RESEARCH.md
@.planning/phases/12-vite-migration/12-01-SUMMARY.md
@app/src/router/routes.js
@app/src/global-components.js
@app/src/main.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove webpack magic comments from routes.js</name>
  <files>app/src/router/routes.js</files>
  <action>
Remove all webpack magic comments from dynamic imports in routes.js.

**Current pattern (60+ occurrences):**
```javascript
component: () => import(/* webpackChunkName: "Home", webpackPrefetch: 1 */ '@/views/Home.vue'),
component: () => import(/* webpackChunkName: "Tables" */ '@/views/tables/Entities.vue'),
```

**Target pattern:**
```javascript
component: () => import('@/views/Home.vue'),
component: () => import('@/views/tables/Entities.vue'),
```

Why this is OK:
- Vite automatically creates chunks based on dynamic imports
- webpackPrefetch is handled differently in Vite (link rel="modulepreload")
- Chunk names are less important in Vite (uses content-based hashing)

Search pattern to find all occurrences:
```regex
/\*\s*webpack[^*]*\*\/\s*
```

The .vue extensions are ALREADY present in routes.js (good!), so no extension changes needed.
  </action>
  <verify>
```bash
# Count webpack comments (should be 0)
grep -c "webpackChunkName\|webpackPrefetch" app/src/router/routes.js | xargs -I {} test {} -eq 0 && echo "PASS: No webpack comments" || echo "FAIL: Webpack comments remain"

# Verify imports still have .vue extension
grep -c "import.*\.vue" app/src/router/routes.js
```
  </verify>
  <done>All webpack magic comments removed from routes.js, dynamic imports preserved</done>
</task>

<task type="auto">
  <name>Task 2: Remove webpack magic comments from global-components.js</name>
  <files>app/src/global-components.js</files>
  <action>
Remove webpack magic comments from all defineAsyncComponent imports.

**Current pattern (19 occurrences):**
```javascript
TablesEntities: defineAsyncComponent(() => import(/* webpackChunkName: "TableComponentsEntities" */ '@/components/tables/TablesEntities.vue')),
```

**Target pattern:**
```javascript
TablesEntities: defineAsyncComponent(() => import('@/components/tables/TablesEntities.vue')),
```

Apply same transformation to all 19 component definitions:
- TablesEntities, TablesGenes, TablesPhenotypes, TablesLogs
- AnalyseGeneClusters, AnalysesPhenotypeClusters
- AnalysesCurationComparisonsTable, AnalysesCurationMatrixPlot, AnalysesCurationUpset
- AnalysesPhenotypeCorrelogram, AnalysesPhenotypeCounts
- AnalysesTimePlot
- HelperBadge, Navbar, Footer
- SearchBar, Banner, LogoutCountdownBadge, IconPairDropdownMenu

The .vue extensions are already present.
  </action>
  <verify>
```bash
# Count webpack comments (should be 0)
grep -c "webpackChunkName" app/src/global-components.js | xargs -I {} test {} -eq 0 && echo "PASS: No webpack comments" || echo "FAIL: Webpack comments remain"
```
  </verify>
  <done>All webpack magic comments removed from global-components.js</done>
</task>

<task type="auto">
  <name>Task 3: Add .vue extensions to component imports missing them</name>
  <files>app/src/**/*.vue, app/src/**/*.js</files>
  <action>
Find and fix all imports of .vue components that are missing the extension.

**Pattern to find (imports from @/ without .vue):**
```javascript
// Missing extension - will fail in Vite
import Something from '@/components/Something'
import { thing } from '@/components/Other'
```

**Correct pattern:**
```javascript
// With extension - works in Vite
import Something from '@/components/Something.vue'
import { thing } from '@/components/Other.vue'
```

**Files to check (based on grep results):**
Search all files for pattern: `from ['"]@/.*['"]` without `.vue` before the quote.

Key areas to check:
1. app/src/components/tables/*.vue - imports from other components
2. app/src/components/analyses/*.vue - imports from other components
3. app/src/views/**/*.vue - component imports
4. app/src/App.vue - layout component imports
5. app/src/main.js - App.vue import

**Exceptions - do NOT add .vue to:**
- JavaScript/TypeScript files: `@/router/routes`, `@/stores/user`
- Asset imports: `@/assets/js/mixins/*`, `@/assets/js/constants/*`
- Plugin imports: `@/plugins/*`

Only add .vue to imports that reference Vue single-file components.
  </action>
  <verify>
```bash
# Find imports from @/components or @/views without .vue
grep -rE "from ['\"]@/(components|views)/[^'\"]+['\"]" app/src/ --include="*.vue" --include="*.js" | grep -v "\.vue['\"]" | head -20
# Should return 0 results if all fixed

# Verify we didn't break JS imports
grep -rE "from ['\"]@/(assets|router|stores|plugins)" app/src/ | grep "\.vue['\"]" | head -5
# Should return 0 results (no .vue on JS files)
```
  </verify>
  <done>All Vue component imports have .vue extension, JS imports unchanged</done>
</task>

</tasks>

<verification>
1. `grep -c "webpackChunkName" app/src/router/routes.js` returns 0
2. `grep -c "webpackChunkName" app/src/global-components.js` returns 0
3. `grep -rE "webpackChunkName|webpackPrefetch" app/src/` returns 0 results
4. No imports from @/components or @/views without .vue extension
5. JS file imports (@/router, @/stores, etc.) do NOT have .vue extension
</verification>

<success_criteria>
- Zero webpack magic comments in codebase
- All Vue component imports include .vue extension
- Dynamic imports still work (just without chunk naming comments)
- No .vue extensions accidentally added to JS imports
</success_criteria>

<output>
After completion, create `.planning/phases/12-vite-migration/12-04-SUMMARY.md`
</output>
