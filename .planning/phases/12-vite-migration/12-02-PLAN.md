---
phase: 12-vite-migration
plan: 02
type: execute
wave: 2
depends_on: [12-01]
files_modified:
  - app/index.html
  - app/public/index.html
autonomous: true

must_haves:
  truths:
    - "index.html exists in app/ root directory (Vite entry point)"
    - "index.html has Vite script tag pointing to /src/main.js"
    - "No webpack placeholders remain in index.html"
  artifacts:
    - path: "app/index.html"
      provides: "Vite entry point HTML file"
      contains: 'type="module"'
    - path: "app/public/index.html"
      provides: "Backup of original (will be removed later)"
  key_links:
    - from: "app/index.html"
      to: "app/src/main.js"
      via: "script tag"
      pattern: 'src="/src/main.js"'
---

<objective>
Migrate index.html from public/ to app root and replace webpack placeholders with Vite-compatible syntax.

Purpose: Configure Vite's entry point correctly - index.html in root is required for Vite to work.
Output: app/index.html ready for Vite dev server.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/12-vite-migration/12-RESEARCH.md
@.planning/phases/12-vite-migration/12-01-SUMMARY.md
@app/public/index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create app/index.html for Vite</name>
  <files>app/index.html</files>
  <action>
Copy app/public/index.html to app/index.html and make these changes:

1. **Replace webpack placeholders:**
   - `<%= BASE_URL %>` → `/` (all occurrences)
   - `<%= htmlWebpackPlugin.options.title %>` → `SysNDD` (all occurrences in title and noscript)

2. **Add Vite entry script** before closing `</body>` tag:
   ```html
   <script type="module" src="/src/main.js"></script>
   ```

3. **Keep all existing content:**
   - Schema.org JSON-LD structured data (important for SEO)
   - Meta tags and link tags
   - noscript fallback message (update title reference)
   - `<div id="app"></div>` mount point

4. **Remove the comment:**
   - Delete `<!-- built files will be auto injected -->` as it's webpack-specific

The result should be a valid HTML5 document that Vite can use as entry point.

Specific replacements:
- `href="<%= BASE_URL %>brain-neurodevelopmental-disorders-sysndd.png"` → `href="/brain-neurodevelopmental-disorders-sysndd.png"`
- `href="<%= BASE_URL %>favicon.ico"` → `href="/favicon.ico"`
- `<title><%= htmlWebpackPlugin.options.title %></title>` → `<title>SysNDD</title>`
- `<%= htmlWebpackPlugin.options.title %> doesn't work` → `SysNDD doesn't work`
  </action>
  <verify>
```bash
# Check no webpack placeholders remain
grep -E "BASE_URL|htmlWebpackPlugin" app/index.html && echo "FAIL: Webpack placeholders found" || echo "PASS: No webpack placeholders"
# Check Vite script tag exists
grep 'type="module".*src="/src/main.js"' app/index.html && echo "PASS: Vite script tag found" || echo "FAIL: Missing Vite script tag"
```
  </verify>
  <done>app/index.html created with all webpack placeholders replaced and Vite entry script added</done>
</task>

<task type="auto">
  <name>Task 2: Verify HTML structure is valid</name>
  <files>app/index.html</files>
  <action>
Verify the migrated index.html:

1. Has proper DOCTYPE declaration
2. Has valid lang attribute on html element
3. Contains exactly one `<div id="app"></div>`
4. Has the Vite module script inside body
5. Schema.org JSON-LD is intact and valid JSON
6. All asset paths start with `/` (not `./`)

If any issues found, fix them.

Note: Keep app/public/index.html unchanged for now - it's still needed for Vue CLI (npm run serve) during the parallel testing period. It will be removed in the cleanup phase.
  </action>
  <verify>
```bash
# Verify HTML has required elements
cat app/index.html | grep -c '<div id="app">' | xargs -I {} test {} -eq 1 && echo "PASS: Single app div" || echo "FAIL: Wrong number of app divs"
cat app/index.html | grep -c 'type="module"' | xargs -I {} test {} -eq 1 && echo "PASS: Module script present" || echo "FAIL: Module script missing"
```
  </verify>
  <done>index.html structure validated, ready for Vite dev server</done>
</task>

</tasks>

<verification>
1. `app/index.html` exists in project root (not just in public/)
2. No `<%= ... %>` template syntax in app/index.html
3. `<script type="module" src="/src/main.js"></script>` present before `</body>`
4. `<title>SysNDD</title>` is hardcoded
5. Schema.org JSON-LD block is preserved
6. `app/public/index.html` still exists (for Vue CLI fallback)
</verification>

<success_criteria>
- app/index.html exists as Vite entry point
- All webpack template placeholders replaced with static values
- Vite module script tag added
- HTML is valid and complete
- Both Vite and Vue CLI can still start (different index.html files)
</success_criteria>

<output>
After completion, create `.planning/phases/12-vite-migration/12-02-SUMMARY.md`
</output>
