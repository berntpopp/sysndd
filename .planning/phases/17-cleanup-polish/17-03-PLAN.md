---
phase: 17-cleanup-polish
plan: 03
type: execute
wave: 2
depends_on: ["17-01"]
files_modified:
  - app/src/global-components.js
  - app/src/main.ts
  - app/src/views/*.vue
  - app/src/components/**/*.vue
autonomous: true
user_setup: []

must_haves:
  truths:
    - "global-components.js file deleted"
    - "All previously global components imported explicitly where used"
    - "Application still renders all views correctly"
    - "No 'component not found' errors at runtime"
  artifacts:
    - path: "app/src/main.ts"
      provides: "Entry point without global component registration"
  key_links:
    - from: "app/src/views/*.vue"
      to: "app/src/components/**/*.vue"
      via: "explicit imports"
      pattern: "import.*from.*@/components"
---

<objective>
Delete global-components.js and convert to explicit component imports

Purpose: Remove legacy global registration pattern in favor of explicit imports for better tree-shaking and code clarity
Output: Components imported explicitly where used, global-components.js deleted
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-cleanup-polish/17-CONTEXT.md
@app/src/global-components.js
@app/src/main.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Identify all global component usages</name>
  <files>app/src/views/*.vue, app/src/components/**/*.vue</files>
  <action>
First, identify what components are registered globally in global-components.js:
- TablesEntities, TablesGenes, TablesPhenotypes, TablesLogs
- AnalyseGeneClusters, AnalysesPhenotypeClusters, AnalysesCurationComparisonsTable
- AnalysesCurationMatrixPlot, AnalysesCurationUpset, AnalysesPhenotypeCorrelogram
- AnalysesPhenotypeCounts, AnalysesTimePlot
- HelperBadge, Navbar, Footer
- SearchBar, Banner, LogoutCountdownBadge, IconPairDropdownMenu
- LoadingSkeleton, TableSkeleton, EmptyState

Search for where each is used:
```bash
for comp in TablesEntities TablesGenes TablesPhenotypes TablesLogs AnalyseGeneClusters AnalysesPhenotypeClusters AnalysesCurationComparisonsTable AnalysesCurationMatrixPlot AnalysesCurationUpset AnalysesPhenotypeCorrelogram AnalysesPhenotypeCounts AnalysesTimePlot HelperBadge Navbar Footer SearchBar Banner LogoutCountdownBadge IconPairDropdownMenu LoadingSkeleton TableSkeleton EmptyState; do
  echo "=== $comp ==="
  grep -rl "<$comp" app/src/ 2>/dev/null || echo "Not found in templates"
done
```

Create a mapping of component -> files that use it.
  </action>
  <verify>
Mapping created showing which files use which global components.
  </verify>
  <done>Component usage mapping complete</done>
</task>

<task type="auto">
  <name>Task 2: Add explicit imports to components that use global components</name>
  <files>app/src/views/*.vue, app/src/components/**/*.vue, app/src/App.vue</files>
  <action>
For each file that uses a global component, add explicit import.

**App.vue likely uses:**
- Navbar, Footer, Banner

Add to App.vue script setup section (or create if needed):
```vue
<script setup lang="ts">
import Navbar from '@/components/Navbar.vue';
import Footer from '@/components/Footer.vue';
import Banner from '@/components/small/Banner.vue';
</script>
```

**Views that use table/analysis components:**
Add imports like:
```vue
<script setup lang="ts">
import TablesGenes from '@/components/tables/TablesGenes.vue';
import TablesEntities from '@/components/tables/TablesEntities.vue';
// etc.
</script>
```

**For components using UI components (LoadingSkeleton, TableSkeleton, EmptyState):**
Add imports:
```vue
<script setup lang="ts">
import LoadingSkeleton from '@/components/ui/LoadingSkeleton.vue';
import TableSkeleton from '@/components/ui/TableSkeleton.vue';
import EmptyState from '@/components/ui/EmptyState.vue';
</script>
```

NOTE: Only add imports for components actually used in each file's template.
NOTE: If a file already has a script section with imports, extend it rather than replace.
NOTE: For Options API components (script without setup), use components: { } option.
  </action>
  <verify>
```bash
cd app && npm run build:production
```
Build succeeds with explicit imports.
  </verify>
  <done>All components that use global components now have explicit imports</done>
</task>

<task type="auto">
  <name>Task 3: Remove global registration from main.ts and delete global-components.js</name>
  <files>app/src/main.ts, app/src/global-components.js</files>
  <action>
1. Remove global component registration from main.ts:
   - Find and remove: `import globalComponents from './global-components'`
   - Find and remove any loop that registers components: `Object.entries(globalComponents).forEach(...)` or similar
   - Keep all other main.ts functionality (router, pinia, bootstrap-vue-next, etc.)

2. Delete global-components.js:
```bash
rm app/src/global-components.js
```

3. Verify no references remain:
```bash
grep -r "global-components" app/src/ || echo "No references found"
```
  </action>
  <verify>
```bash
cd app && npm run dev &
sleep 5
curl -s http://localhost:5173 | head -20
pkill -f "vite"
cd app && npm run test:unit
```
Dev server starts, app renders, tests pass.
  </verify>
  <done>global-components.js deleted, main.ts cleaned up, all components import explicitly</done>
</task>

</tasks>

<verification>
- [ ] global-components.js file deleted
- [ ] main.ts has no global component registration
- [ ] All views and components have explicit imports for what they use
- [ ] npm run build:production succeeds
- [ ] npm run dev shows no component resolution errors
- [ ] npm run test:unit passes
- [ ] No grep matches for "global-components" in app/src/
</verification>

<success_criteria>
- global-components.js removed from codebase
- All previously global components imported explicitly
- Application renders all pages correctly
- No runtime component resolution errors
- Better tree-shaking enabled through explicit imports
</success_criteria>

<output>
After completion, create `.planning/phases/17-cleanup-polish/17-03-SUMMARY.md`
</output>
