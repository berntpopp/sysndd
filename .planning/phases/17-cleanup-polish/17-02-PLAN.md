---
phase: 17-cleanup-polish
plan: 02
type: execute
wave: 2
depends_on: ["17-01"]
files_modified:
  - app/vite.config.ts
  - app/package.json
  - app/src/main.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Application runs without @vue/compat"
    - "No Vue 2 compatibility warnings in console"
    - "All existing tests pass without compat layer"
    - "Development server starts successfully"
  artifacts:
    - path: "app/vite.config.ts"
      provides: "Standard Vue 3 configuration"
      contains: "vue()"
    - path: "app/package.json"
      provides: "Updated dependencies without @vue/compat"
  key_links:
    - from: "app/vite.config.ts"
      to: "@vitejs/plugin-vue"
      via: "vue() plugin call"
      pattern: "vue\\(\\)"
---

<objective>
Remove @vue/compat compatibility layer and verify pure Vue 3 operation

Purpose: Complete Vue 3 migration by removing the compatibility bridge that was used during incremental migration
Output: Application running on standard Vue 3 without compatibility layer
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-cleanup-polish/17-CONTEXT.md
@.planning/phases/17-cleanup-polish/17-RESEARCH.md
@app/vite.config.ts
@app/package.json
@app/src/main.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove @vue/compat from vite.config.ts</name>
  <files>app/vite.config.ts</files>
  <action>
Update vite.config.ts to remove Vue 2 compatibility:

1. Remove the vue alias that points to @vue/compat:
   - DELETE: `vue: '@vue/compat'` from resolve.alias
   - KEEP: `'@': fileURLToPath(new URL('./src', import.meta.url))`

2. Remove compatConfig from vue plugin:
   - CHANGE: From `vue({ template: { compilerOptions: { compatConfig: { MODE: 2 } } } })`
   - TO: `vue()`

3. Keep all other configuration unchanged (PWA, visualizer, build options, etc.)

Expected result - vue plugin section should be:
```typescript
plugins: [
  vue(),
  VitePWA({ ... }),
  visualizer({ ... }),
],
```

And resolve.alias should be:
```typescript
resolve: {
  alias: {
    '@': fileURLToPath(new URL('./src', import.meta.url)),
  },
},
```
  </action>
  <verify>
```bash
cd app && npm run dev &
sleep 5
curl -s http://localhost:5173 | head -20
pkill -f "vite"
```
Dev server starts without Vue compat warnings.
  </verify>
  <done>vite.config.ts updated to use standard Vue 3 plugin without compat mode</done>
</task>

<task type="auto">
  <name>Task 2: Remove @vue/compat package and verify</name>
  <files>app/package.json</files>
  <action>
Uninstall @vue/compat:
```bash
cd app && npm uninstall @vue/compat
```

Verify vue is still installed as direct dependency (should be ^3.5.25).

Run full verification:
```bash
cd app && npm run build:production
cd app && npm run test:unit
```

Check for any remaining @vue/compat references:
```bash
grep -r "@vue/compat" app/src/ || echo "No compat references found"
```

If any compat-specific patterns are found in the code (like `compatConfig`), remove them.
  </action>
  <verify>
```bash
cd app && npm ls vue && npm ls @vue/compat 2>&1 | grep -q "empty" && echo "compat removed"
cd app && npm run test:unit
```
@vue/compat not in dependency tree, tests pass.
  </verify>
  <done>@vue/compat uninstalled, application verified working with pure Vue 3</done>
</task>

</tasks>

<verification>
- [ ] @vue/compat removed from package.json dependencies
- [ ] vite.config.ts uses vue() without compatConfig
- [ ] No vue: '@vue/compat' alias in resolve
- [ ] npm run dev starts without errors
- [ ] npm run build:production succeeds
- [ ] npm run test:unit passes
- [ ] No compat-related console warnings
</verification>

<success_criteria>
- Application runs on standard Vue 3 (no compat layer)
- All 144+ existing tests pass
- Production build succeeds
- No Vue 2 compatibility patterns remain in configuration
</success_criteria>

<output>
After completion, create `.planning/phases/17-cleanup-polish/17-02-SUMMARY.md`
</output>
