---
phase: 41-gene-page-redesign
plan: 03
type: execute
wave: 2
depends_on: ["41-01"]
files_modified:
  - app/src/components/gene/GeneHero.vue
  - app/src/components/gene/IdentifierCard.vue
  - app/src/components/gene/ClinicalResourcesCard.vue
autonomous: true

must_haves:
  truths:
    - "GeneHero displays gene symbol badge, full gene name, and chromosome location"
    - "GeneHero is display-only with no interactive elements"
    - "IdentifierCard renders all gene identifiers using IdentifierRow components"
    - "ClinicalResourcesCard groups clinical resources by type using ResourceLink components"
    - "All three components accept typed props and render correctly with partial data"
  artifacts:
    - path: "app/src/components/gene/GeneHero.vue"
      provides: "Hero section with symbol, name, location"
      min_lines: 30
    - path: "app/src/components/gene/IdentifierCard.vue"
      provides: "Card containing all identifier rows"
      min_lines: 50
    - path: "app/src/components/gene/ClinicalResourcesCard.vue"
      provides: "Clinical resources grid with grouped links"
      min_lines: 50
  key_links:
    - from: "app/src/components/gene/IdentifierCard.vue"
      to: "app/src/components/gene/IdentifierRow.vue"
      via: "component import and usage"
      pattern: "IdentifierRow"
    - from: "app/src/components/gene/ClinicalResourcesCard.vue"
      to: "app/src/components/gene/ResourceLink.vue"
      via: "component import and usage"
      pattern: "ResourceLink"
    - from: "app/src/components/gene/GeneHero.vue"
      to: "app/src/components/ui/GeneBadge.vue"
      via: "component import for symbol badge"
      pattern: "GeneBadge"
---

<objective>
Create the three section-level components that compose the gene page layout: GeneHero (top banner), IdentifierCard (database IDs), and ClinicalResourcesCard (external resource links).

Purpose: These components use the IdentifierRow and ResourceLink building blocks from Plan 01 to create the organized, card-based layout that replaces the flat BTable. Each component owns a distinct section of the gene page.

Output: Three Vue 3 `<script setup>` components in `app/src/components/gene/`.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-gene-page-redesign/41-CONTEXT.md
@.planning/phases/41-gene-page-redesign/41-RESEARCH.md
@.planning/phases/41-gene-page-redesign/41-01-SUMMARY.md

Key patterns:
@app/src/components/ui/GeneBadge.vue (reuse in hero section)
@app/src/views/admin/components/statistics/StatCard.vue (script setup pattern)

Components created in Plan 01 (available for import):
- app/src/components/gene/IdentifierRow.vue
- app/src/components/gene/ResourceLink.vue
- app/src/types/gene.ts (GeneApiData interface)

API data shape reminder:
Every field is string[]. Access first element: `geneData.symbol[0]`.
bed_hg38 example: ["chr17:41196311-41277500"] or [null].
Clinical resource URLs constructed from IDs:
- HGNC: https://www.genenames.org/data/gene-symbol-report/#!/symbol/{symbol}
- OMIM: https://www.omim.org/entry/{omim_id}
- ClinGen: https://search.clinicalgenome.org/kb/genes/{hgnc_id}
- SFARI: https://gene.sfari.org/database/human-gene/{symbol}
- PanelApp: https://panelapp.genomicsengland.co.uk/panels/entities/{symbol}
- gene2phenotype: https://www.ebi.ac.uk/gene2phenotype/search?panel=ALL&search_term={symbol}
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GeneHero component</name>
  <files>app/src/components/gene/GeneHero.vue</files>
  <action>
Create `app/src/components/gene/GeneHero.vue` — the hero banner at the top of the gene page.

Requirements (REDESIGN-01):
- Props: `symbol` (string, required), `name` (string, optional), `chromosomeLocation` (string, optional — this is the bed_hg38 value like "chr17:41196311-41277500")
- Display-only: NO buttons, copy actions, or interactive elements in the hero area (per CONTEXT.md)
- Layout:
  - GeneBadge component (size="lg") showing the gene symbol
  - Gene full name displayed prominently (e.g., "methyl-CpG binding protein 2")
  - Chromosome location displayed below name in smaller muted text (e.g., "chrX:154021572-154137103")
  - If chromosomeLocation is missing/null, show "Location not available" in muted text
  - If name is missing, show only the badge and location
- Styling:
  - Subtle background (light gradient or very light gray, consistent with SysNDD patterns)
  - Padding: generous vertical padding (py-4) for visual breathing room
  - Text alignment: left-aligned
  - The GeneBadge should NOT link anywhere (set linkTo to null/undefined) — the user is already on the gene page
- Use `<script setup lang="ts">`.
- Import and use GeneBadge from `@/components/ui/GeneBadge.vue`.

Do NOT add identifiers (Entrez, Ensembl, etc.) to the hero — those go in IdentifierCard.
  </action>
  <verify>Run `cd /home/bernt-popp/development/sysndd/app && npx tsc --noEmit --pretty 2>&1 | head -20` and `npx eslint src/components/gene/GeneHero.vue 2>&1 | head -20`.</verify>
  <done>GeneHero.vue displays gene symbol badge, name, and chromosome location. Display-only, no interactive elements. Shows "Location not available" for missing coordinates.</done>
</task>

<task type="auto">
  <name>Task 2: Create IdentifierCard component</name>
  <files>app/src/components/gene/IdentifierCard.vue</files>
  <action>
Create `app/src/components/gene/IdentifierCard.vue` — card containing all gene database identifiers.

Requirements (REDESIGN-02):
- Props: Accept a single `geneData` prop typed as `GeneApiData` (from `@/types/gene`). This is one element from the API response array (the parent will pass `geneData[0]`).
- Content: Render an IdentifierRow for each identifier:
  1. HGNC ID — label: "HGNC", value: `geneData.hgnc_id[0]`, no external URL (already linked in hero badge)
  2. Entrez — label: "Entrez", value: `geneData.entrez_id[0]`, externalUrl: `https://www.ncbi.nlm.nih.gov/gene/{id}`
  3. Ensembl — label: "Ensembl", value: `geneData.ensembl_gene_id[0]`, externalUrl: `https://www.ensembl.org/Homo_sapiens/Gene/Summary?g={id}`
  4. UniProt — label: "UniProt", value: `geneData.uniprot_ids[0]`, externalUrl: `https://www.uniprot.org/uniprot/{id}`
  5. UCSC — label: "UCSC", value: `geneData.ucsc_id[0]`, externalUrl: `https://genome-euro.ucsc.edu/cgi-bin/hgGene?hgg_gene={id}&db=hg38`
  6. CCDS — label: "CCDS", value: `geneData.ccds_id[0]`, externalUrl: `https://www.ncbi.nlm.nih.gov/CCDS/CcdsBrowse.cgi?REQUEST=CCDS&DATA={id}`
  7. STRING — label: "STRING", value: `geneData.STRING_id[0]`, externalUrl: `https://string-db.org/network/{id}`
  8. MANE Select — label: "MANE Select", value: `geneData.mane_select[0]`, no external URL (transcript ID only)
- Card styling: BCard with subtle drop shadow (`box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)`, `border: none`).
- Card header: "Identifiers" as h5, styled consistently with SysNDD cards.
- Use `<script setup lang="ts">`.
- Import IdentifierRow from `@/components/gene/IdentifierRow.vue`.
- Import GeneApiData from `@/types/gene`.

Use computed properties for external URLs to avoid template complexity. Example:
```typescript
const entrezUrl = computed(() => {
  const id = props.geneData?.entrez_id?.[0];
  return id ? `https://www.ncbi.nlm.nih.gov/gene/${id}` : undefined;
});
```

Each IdentifierRow handles its own empty state ("Not available") — do NOT add v-if logic to hide rows with missing values.
  </action>
  <verify>Run `cd /home/bernt-popp/development/sysndd/app && npx tsc --noEmit --pretty 2>&1 | head -20` and `npx eslint src/components/gene/IdentifierCard.vue 2>&1 | head -20`.</verify>
  <done>IdentifierCard.vue renders 8 identifier rows using IdentifierRow component, each with computed external URLs. Card has drop shadow styling. Empty states handled by IdentifierRow.</done>
</task>

<task type="auto">
  <name>Task 3: Create ClinicalResourcesCard component</name>
  <files>app/src/components/gene/ClinicalResourcesCard.vue</files>
  <action>
Create `app/src/components/gene/ClinicalResourcesCard.vue` — card-grid of clinical resource links.

Requirements (REDESIGN-03, REDESIGN-04):
- Props: `symbol` (string, required), `hgncId` (string, optional), `omimId` (string, optional), `mgdId` (string, optional), `rgdId` (string, optional)
- Content: ResourceLink components organized into groups per CONTEXT.md decision.

Group 1 — "Curation":
  - ClinGen: name="ClinGen", url=`https://search.clinicalgenome.org/kb/genes/{hgncId}`, description="Gene-disease validity", available=!!hgncId
  - SFARI: name="SFARI", url=`https://gene.sfari.org/database/human-gene/{symbol}`, description="Autism gene database", available=true (always available if symbol exists)

Group 2 — "Disease / Phenotype":
  - OMIM: name="OMIM", url=`https://www.omim.org/entry/{omimId}`, description="Mendelian inheritance", available=!!omimId
  - gene2phenotype: name="gene2phenotype", url=`https://www.ebi.ac.uk/gene2phenotype/search?panel=ALL&search_term={symbol}`, description="Genotype-phenotype", available=true
  - PanelApp: name="PanelApp", url=`https://panelapp.genomicsengland.co.uk/panels/entities/{symbol}`, description="Gene panels", available=true

Group 3 — "Gene Information":
  - HGNC: name="HGNC", url=`https://www.genenames.org/data/gene-symbol-report/#!/symbol/{symbol}`, description="Gene nomenclature", available=true

Group 4 — "Model Organisms" (REDESIGN-04):
  - MGI: name="MGI (Mouse)", url=`http://www.informatics.jax.org/marker/{mgdId}`, description="Mouse genome informatics", available=!!mgdId, icon="bi-file-earmark-medical"
  - RGD: name="RGD (Rat)", url=`https://rgd.mcw.edu/rgdweb/report/gene/main.html?id={rgdId}`, description="Rat genome database", available=!!rgdId, icon="bi-file-earmark-medical"

- Layout: Each group has a heading (h6, text-muted, uppercase, small). Within each group, ResourceLink components are displayed in a responsive grid: `BRow` with `BCol cols="12" md="6" lg="4"` and gap class `g-3`.
- Card styling: Same drop shadow as IdentifierCard. Card header: "Clinical Resources & Databases" as h5.
- Use `<script setup lang="ts">`.
- Import ResourceLink from `@/components/gene/ResourceLink.vue`.
- Use computed properties for URLs that depend on optional IDs.

Unavailable resources (e.g., ClinGen when hgncId is missing) are shown grayed out by ResourceLink — do NOT hide them. Per CONTEXT.md: "show the card/link but grayed out with 'No entry' indicator — user sees the full set of possible resources."
  </action>
  <verify>Run `cd /home/bernt-popp/development/sysndd/app && npx tsc --noEmit --pretty 2>&1 | head -20` and `npx eslint src/components/gene/ClinicalResourcesCard.vue 2>&1 | head -20`.</verify>
  <done>ClinicalResourcesCard.vue renders 8 clinical resources in 4 groups using ResourceLink components. Responsive grid layout. Unavailable resources shown grayed out. Model organisms section included with MGI/RGD.</done>
</task>

</tasks>

<verification>
1. Three new components exist in `app/src/components/gene/`
2. GeneHero uses GeneBadge, accepts symbol/name/chromosomeLocation props
3. IdentifierCard imports and uses IdentifierRow for 8 identifiers
4. ClinicalResourcesCard imports and uses ResourceLink for 8 resources in 4 groups
5. All components use `<script setup lang="ts">`
6. TypeScript compiles cleanly
7. ESLint passes for all three files
</verification>

<success_criteria>
- GeneHero: Shows gene badge (lg), name, chromosome location. Display-only. Handles missing name/location gracefully.
- IdentifierCard: 8 identifier rows (HGNC, Entrez, Ensembl, UniProt, UCSC, CCDS, STRING, MANE Select) with computed external URLs. Drop shadow card.
- ClinicalResourcesCard: 8 resources in 4 groups (Curation, Disease/Phenotype, Gene Information, Model Organisms). Responsive grid. Unavailable resources grayed out.
- All pass TypeScript + ESLint
</success_criteria>

<output>
After completion, create `.planning/phases/41-gene-page-redesign/41-03-SUMMARY.md`
</output>
