---
phase: 41-gene-page-redesign
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/src/components/gene/IdentifierRow.vue
  - app/src/components/gene/ResourceLink.vue
  - app/src/types/gene.ts
autonomous: true

must_haves:
  truths:
    - "IdentifierRow renders a label, value, copy button, and external link button in a single row"
    - "ResourceLink renders a card-style external resource link with icon, name, and description"
    - "IdentifierRow shows 'Not available' in muted gray when value is missing"
    - "ResourceLink shows grayed-out state with 'No entry' when resource is unavailable"
    - "GeneApiData interface types all fields returned by the gene API endpoint"
  artifacts:
    - path: "app/src/components/gene/IdentifierRow.vue"
      provides: "Reusable identifier row with copy-to-clipboard and external link"
      min_lines: 40
    - path: "app/src/components/gene/ResourceLink.vue"
      provides: "Card-style external resource link component"
      min_lines: 30
    - path: "app/src/types/gene.ts"
      provides: "TypeScript interface for gene API response"
      contains: "GeneApiData"
  key_links:
    - from: "app/src/components/gene/IdentifierRow.vue"
      to: "navigator.clipboard"
      via: "copyToClipboard function"
      pattern: "navigator\\.clipboard\\.writeText"
    - from: "app/src/components/gene/IdentifierRow.vue"
      to: "useToast"
      via: "composable import for copy feedback"
      pattern: "useToast|makeToast"
---

<objective>
Create the reusable building-block components (IdentifierRow, ResourceLink) and TypeScript types that all other gene page components will consume.

Purpose: These atomic components eliminate the repeated inline button/link patterns in the current GeneView.vue (11 fields x duplicate code). Every identifier and clinical resource link on the redesigned page will use one of these two components.

Output: Two Vue 3 `<script setup>` components in `app/src/components/gene/` and a TypeScript interface in `app/src/types/gene.ts`.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-gene-page-redesign/41-CONTEXT.md
@.planning/phases/41-gene-page-redesign/41-RESEARCH.md

Key existing patterns to follow:
@app/src/views/admin/components/statistics/StatCard.vue (script setup pattern)
@app/src/components/ui/GeneBadge.vue (badge styling, 3D gradient)
@app/src/composables/useToast.ts (toast notification for copy feedback)

API response structure (gene endpoint returns array-wrapped fields):
The gene endpoint at `/api/gene/<symbol>` returns an array of objects where every field is pipe-split into arrays.
Fields: hgnc_id, symbol, name, entrez_id, ensembl_gene_id, ucsc_id, ccds_id, uniprot_ids, omim_id, mane_select, mgd_id, rgd_id, STRING_id.
After Plan 02 completes, also: bed_hg38.
All fields are `string[]` after the `str_split` mutation in R.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GeneApiData TypeScript interface</name>
  <files>app/src/types/gene.ts</files>
  <action>
Create a new file `app/src/types/gene.ts` with a TypeScript interface matching the gene API endpoint response.

Define `GeneApiData` interface:
```typescript
export interface GeneApiData {
  hgnc_id: string[];
  symbol: string[];
  name: string[];
  entrez_id: string[];
  ensembl_gene_id: string[];
  ucsc_id: string[];
  ccds_id: string[];
  uniprot_ids: string[];
  omim_id: string[];
  mane_select: string[];
  mgd_id: string[];
  rgd_id: string[];
  STRING_id: string[];
  bed_hg38: string[];  // Added by Plan 02 - chromosome coordinates like "chr17:12345-67890"
}
```

IMPORTANT: Every field is `string[]` because the R backend pipes all fields through `str_split(., pattern = "\\|")`. Even single-value fields like `symbol` come back as arrays.

Also export a barrel from `app/src/types/index.ts` — add `export type { GeneApiData } from './gene';` to the existing barrel file.

Do NOT modify the existing `Gene` interface in `models.ts` — that is a lightweight model used elsewhere. `GeneApiData` is the full API response shape for the gene detail page.
  </action>
  <verify>Run `cd /home/bernt-popp/development/sysndd/app && npx tsc --noEmit --pretty 2>&1 | head -30` to confirm no TypeScript errors.</verify>
  <done>GeneApiData interface exists in app/src/types/gene.ts, is exported from app/src/types/index.ts, and TypeScript compilation passes with no errors.</done>
</task>

<task type="auto">
  <name>Task 2: Create IdentifierRow and ResourceLink components</name>
  <files>
    app/src/components/gene/IdentifierRow.vue
    app/src/components/gene/ResourceLink.vue
  </files>
  <action>
Create directory `app/src/components/gene/` if it does not exist.

**IdentifierRow.vue** — Reusable row for displaying a gene identifier with copy-to-clipboard and external link.

Requirements (from REDESIGN-07):
- Props: `label` (string, required), `value` (string | undefined), `externalUrl` (string | undefined), `externalLabel` (string, default: label), `showCopy` (boolean, default: true)
- Layout: Label on left, value + copy button + external link button on right (use flexbox or BRow/BCol)
- When `value` is falsy or empty string: show "Not available" in muted gray text. Still show the label. Do NOT hide the row. Do NOT show copy/link buttons when no value.
- Copy button: Small outline button with `bi-clipboard` icon. On click, call `navigator.clipboard.writeText(value)`. Show toast feedback "Copied!" via `useToast` composable (follow pattern from PublicationsNDDTable.vue). Wrap in try/catch.
- External link button: Small outline-primary button with `bi-box-arrow-up-right` icon. Opens in new tab (`target="_blank"`, `rel="noopener noreferrer"`). Only shown when `externalUrl` is provided.
- Use `<script setup lang="ts">` with typed props via `defineProps<Props>()` and `withDefaults()`.
- Scoped styles: Use existing `.btn-xs` pattern from GeneView.vue for small buttons.
- Accessibility: Copy button has `aria-label="Copy {label} to clipboard"`. External link has `aria-label="Open {label} in {externalLabel}"`.

**ResourceLink.vue** — Card-style external resource link (from REDESIGN-08).

Requirements:
- Props: `name` (string, required), `url` (string | undefined), `description` (string, optional), `icon` (string, default: 'bi-database'), `available` (boolean, default: true)
- Layout: A small card/tile with icon on left, name and description on right. The entire card is clickable as a link when available.
- When `available` is false OR `url` is falsy: card appears grayed out with "No entry" indicator text. Card is not clickable.
- When available: card has subtle hover effect (shadow increase), opens link in new tab.
- Use `<script setup lang="ts">`.
- Scoped styles: Card has `box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)`, `border: none` (matching SysNDD card pattern from research). Unavailable state: `opacity: 0.5`, cursor default.
- Accessibility: `aria-label="Open {name}"` on the link. Unavailable cards have `aria-disabled="true"`.
  </action>
  <verify>
Run `cd /home/bernt-popp/development/sysndd/app && npx tsc --noEmit --pretty 2>&1 | head -30` to confirm no TypeScript errors.
Run `cd /home/bernt-popp/development/sysndd/app && npx eslint src/components/gene/IdentifierRow.vue src/components/gene/ResourceLink.vue --no-error-on-unmatched-pattern 2>&1 | head -20` to check for lint issues.
  </verify>
  <done>
IdentifierRow.vue renders label-value rows with copy and external link buttons, shows "Not available" for missing values, and uses useToast for copy feedback.
ResourceLink.vue renders card-style resource links with grayed-out unavailable state.
Both components use script setup with TypeScript, pass lint, and follow existing SysNDD styling patterns.
  </done>
</task>

</tasks>

<verification>
1. `app/src/types/gene.ts` exists and exports `GeneApiData` interface
2. `app/src/types/index.ts` re-exports `GeneApiData`
3. `app/src/components/gene/IdentifierRow.vue` exists with script setup, typed props, copy-to-clipboard, external link, empty state
4. `app/src/components/gene/ResourceLink.vue` exists with script setup, typed props, card layout, unavailable state
5. TypeScript compilation passes: `npx tsc --noEmit`
6. ESLint passes for new files
</verification>

<success_criteria>
- GeneApiData interface matches all 13 fields from gene API (all string[])
- IdentifierRow handles: value present (shows value + buttons), value missing (shows "Not available"), clipboard copy with toast feedback
- ResourceLink handles: available link (clickable card), unavailable link (grayed out, not clickable)
- No TypeScript errors, no ESLint errors
- Components follow script setup pattern from StatCard.vue
</success_criteria>

<output>
After completion, create `.planning/phases/41-gene-page-redesign/41-01-SUMMARY.md`
</output>
