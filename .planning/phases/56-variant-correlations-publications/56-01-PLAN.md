---
phase: 56-variant-correlations-publications
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/src/components/analyses/AnalysesVariantCorrelogram.vue
  - app/src/components/analyses/AnalysesVariantCounts.vue
autonomous: true

must_haves:
  truths:
    - "Clicking a cell in variant correlation matrix navigates to Entities table filtered by those variants"
    - "Clicking a bar in variant counts chart navigates to Entities table filtered by that variant"
    - "Navigation links include correct filter parameters for modifier_variant_id"
  artifacts:
    - path: "app/src/components/analyses/AnalysesVariantCorrelogram.vue"
      provides: "Correlation matrix with working navigation links"
      contains: "/Entities/"
    - path: "app/src/components/analyses/AnalysesVariantCounts.vue"
      provides: "Variant counts chart with working navigation links"
      contains: "/Entities/"
  key_links:
    - from: "AnalysesVariantCorrelogram.vue"
      to: "/Entities/ route"
      via: "xlink:href attribute on SVG elements"
      pattern: "/Entities/\\?.*filter="
    - from: "AnalysesVariantCounts.vue"
      to: "/Entities/ route"
      via: "xlink:href attribute on SVG elements"
      pattern: "/Entities/\\?.*filter="
---

<objective>
Fix broken navigation links in VariantCorrelations and VariantCounts views.

Purpose: Both variant analysis charts generate links to `/Variants/` route which does not exist in the router, causing 404 errors when users click chart elements. These links should route to the Entities table with variant filter parameters.

Output: Working navigation from variant charts to filtered Entities table view.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/56-variant-correlations-publications/56-CONTEXT.md
@.planning/phases/56-variant-correlations-publications/56-RESEARCH.md
@app/src/components/analyses/AnalysesVariantCorrelogram.vue
@app/src/components/analyses/AnalysesVariantCounts.vue
@app/src/router/routes.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix AnalysesVariantCorrelogram navigation links</name>
  <files>app/src/components/analyses/AnalysesVariantCorrelogram.vue</files>
  <action>
Update the navigation link in the D3 chart generation code (around line 193-197).

Current broken code:
```javascript
.attr(
  'xlink:href',
  (d) =>
    `/Variants/?sort=entity_id&filter=any(category,Definitive),all(modifier_variant_id,${d.x_vario_id},${d.y_vario_id})&page_after=0&page_size=10`
)
```

Change `/Variants/` to `/Entities/`:
```javascript
.attr(
  'xlink:href',
  (d) =>
    `/Entities/?sort=entity_id&filter=any(category,Definitive),all(modifier_variant_id,${d.x_vario_id},${d.y_vario_id})&page_after=0&page_size=10`
)
```

Also update the aria-label to match (around line 198-201):
```javascript
.attr(
  'aria-label',
  (d) => `Link to entities table for variant combination ${d.x_vario_id} and ${d.y_vario_id}`
)
```
  </action>
  <verify>
1. Run `npm run lint` in app/ directory - no new linting errors
2. Run `npm run type-check` in app/ directory - no TypeScript errors
3. Manual verification: Start dev server, navigate to Variant Correlations view, click a correlation matrix cell - should navigate to /Entities/ with filter parameters
  </verify>
  <done>
Clicking any cell in the variant correlation matrix navigates to the Entities table with correct filter parameters (modifier_variant_id for both variants).
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix AnalysesVariantCounts navigation links</name>
  <files>app/src/components/analyses/AnalysesVariantCounts.vue</files>
  <action>
Update the navigation link in the D3 bar chart generation code (around line 191-195).

Current broken code:
```javascript
.attr(
  'xlink:href',
  (d) =>
    `/Variants/?sort=entity_id&filter=any(category,Definitive),all(modifier_variant_id,${d.vario_id})&page_after=0&page_size=10`
)
```

Change `/Variants/` to `/Entities/`:
```javascript
.attr(
  'xlink:href',
  (d) =>
    `/Entities/?sort=entity_id&filter=any(category,Definitive),all(modifier_variant_id,${d.vario_id})&page_after=0&page_size=10`
)
```

Also update the aria-label to match (around line 196):
```javascript
.attr('aria-label', (d) => `Link to entities table for variant ${d.vario_id}`)
```
  </action>
  <verify>
1. Run `npm run lint` in app/ directory - no new linting errors
2. Run `npm run type-check` in app/ directory - no TypeScript errors
3. Manual verification: Start dev server, navigate to Variant Counts view, click a bar - should navigate to /Entities/ with filter parameters
  </verify>
  <done>
Clicking any bar in the variant counts chart navigates to the Entities table with correct filter parameters (modifier_variant_id for that variant).
  </done>
</task>

</tasks>

<verification>
## Automated Checks
```bash
cd app && npm run lint && npm run type-check
```

## Manual Verification
1. Start dev server: `cd app && npm run dev`
2. Navigate to Variant Correlations view (typically under Analyses tab)
3. Click a cell in the correlation matrix
4. Verify: URL changes to `/Entities/?sort=entity_id&filter=any(category,Definitive),all(modifier_variant_id,...)&page_after=0&page_size=10`
5. Verify: Entities table displays filtered results
6. Navigate to Variant Counts view
7. Click a bar in the bar chart
8. Verify: URL changes to `/Entities/?...` with correct filter
9. Verify: Entities table displays filtered results

## Regression Check
- Tooltips on chart elements still work
- Chart rendering is unchanged
- Download buttons still function
</verification>

<success_criteria>
1. VCOR-01: VariantCorrelations view navigation links route to `/Entities/` with correct filter parameters
2. VCOR-02: VariantCounts view navigation links route to `/Entities/` with correct filter parameters
3. No new linting or TypeScript errors introduced
4. Existing chart functionality (tooltips, rendering, downloads) unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/56-variant-correlations-publications/56-01-SUMMARY.md`
</output>
