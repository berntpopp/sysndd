---
phase: 16-ui-ux-modernization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/src/assets/scss/_variables.scss
  - app/src/assets/scss/_design-tokens.scss
  - app/src/assets/scss/partials/_colors.scss
  - app/src/assets/scss/partials/_shadows.scss
  - app/src/assets/scss/partials/_spacing.scss
  - app/src/assets/scss/partials/_typography.scss
  - app/src/assets/scss/custom.scss
autonomous: true
user_setup: []

must_haves:
  truths:
    - "CSS custom properties are available globally for colors, shadows, spacing"
    - "Medical blue/teal color palette accessible via --medical-* variables"
    - "Shadow depth system provides subtle elevation levels (xs through xl)"
    - "Spacing scale supports compact density for data-heavy views"
  artifacts:
    - path: "app/src/assets/scss/_design-tokens.scss"
      provides: "CSS custom properties design tokens"
      contains: ":root"
    - path: "app/src/assets/scss/partials/_colors.scss"
      provides: "Medical color palette"
      contains: "--medical-blue"
    - path: "app/src/assets/scss/partials/_shadows.scss"
      provides: "Shadow depth system"
      contains: "--shadow-"
  key_links:
    - from: "app/src/assets/scss/custom.scss"
      to: "partials/*"
      via: "@use or @import"
      pattern: "@use.*partials|@import.*partials"
---

<objective>
Create CSS custom properties design token system for Phase 16 UI/UX modernization.

Purpose: Establish the foundation for all subsequent styling plans. CSS custom properties enable runtime theming, consistent design tokens, and potential dark mode support. This is the SCSS architecture foundation that all other plans will build upon.

Output: SCSS partial files with design tokens (colors, shadows, spacing, typography) that extend Bootstrap's CSS custom properties system.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-ui-ux-modernization/16-CONTEXT.md
@.planning/phases/16-ui-ux-modernization/16-RESEARCH.md
@app/src/assets/scss/custom.scss
@app/src/main.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SCSS architecture with partials structure</name>
  <files>
    app/src/assets/scss/_variables.scss
    app/src/assets/scss/_design-tokens.scss
    app/src/assets/scss/partials/_colors.scss
    app/src/assets/scss/partials/_shadows.scss
    app/src/assets/scss/partials/_spacing.scss
    app/src/assets/scss/partials/_typography.scss
  </files>
  <action>
    Create the SCSS partial file structure following Bootstrap's customization pattern.

    1. Create `app/src/assets/scss/partials/` directory

    2. Create `_variables.scss` - Bootstrap variable overrides (compilation time):
       - $primary: #0d47a1 (medical blue)
       - $enable-shadows: true
       - $enable-gradients: false (per CONTEXT: modern scientific, not clinical)
       - Override $box-shadow-sm, $box-shadow, $box-shadow-lg with subtle medical values

    3. Create `partials/_colors.scss` - Medical color palette as CSS custom properties:
       - Medical blue scale: --medical-blue-50 through --medical-blue-900
       - Medical teal scale: --medical-teal-50 through --medical-teal-700
       - Status colors (colorblind-safe): --status-success, --status-warning, --status-danger, --status-info
       - All colors must meet WCAG 2.2 4.5:1 contrast on white

    4. Create `partials/_shadows.scss` - Shadow depth system:
       - --shadow-none, --shadow-xs, --shadow-sm, --shadow-md, --shadow-lg, --shadow-xl
       - Subtle shadows for medical/scientific aesthetic (per CONTEXT)
       - Utility classes: .shadow-xs, .shadow-md, .shadow-xl

    5. Create `partials/_spacing.scss` - Compact spacing scale:
       - --spacing-compact: 0.5rem (for data-heavy views)
       - --spacing-base: 0.75rem
       - --spacing-comfortable: 1rem

    6. Create `partials/_typography.scss` - Typography tokens:
       - Font stack variables
       - --font-weight-normal, --font-weight-medium, --font-weight-bold

    7. Create `_design-tokens.scss` - Main design tokens file that imports all partials

    Reference the RESEARCH.md patterns for exact CSS custom property syntax.
  </action>
  <verify>
    - All files exist in app/src/assets/scss/
    - Each file has valid SCSS syntax: `npm run build --prefix app 2>&1 | head -20`
    - partials/_colors.scss contains --medical-blue-700: #0d47a1
  </verify>
  <done>
    SCSS partial structure created with medical color palette, shadow system, spacing scale, and typography tokens
  </done>
</task>

<task type="auto">
  <name>Task 2: Update custom.scss with proper Bootstrap import order</name>
  <files>app/src/assets/scss/custom.scss</files>
  <action>
    Restructure custom.scss following Bootstrap's required import order (per RESEARCH.md Pitfall 1):

    1. @use "bootstrap/scss/functions"
    2. @use "./_variables" (custom variable overrides)
    3. @use "bootstrap/scss/variables"
    4. @use "bootstrap/scss/variables-dark"
    5. @use "bootstrap/scss/maps"
    6. @use "bootstrap/scss/mixins"
    7. @use "bootstrap/scss/root"
    8. @use "./_design-tokens" (CSS custom properties)
    9. Import component-specific partials as needed

    CRITICAL: Use @use syntax with modern-compiler API (per STATE.md decision).
    NOTE: The main Bootstrap CSS is already imported in main.ts via 'bootstrap/dist/css/bootstrap.css'. This file extends it with custom tokens.

    Keep existing color definitions that are still needed but move them to _variables.scss.
  </action>
  <verify>
    - `npm run build --prefix app` succeeds
    - `npm run dev --prefix app` starts without SCSS errors
    - Browser dev tools show CSS custom properties on :root (--medical-blue-*, --shadow-*)
  </verify>
  <done>
    custom.scss restructured with proper import order, design tokens available globally
  </done>
</task>

<task type="auto">
  <name>Task 3: Add transition tokens with reduced-motion support</name>
  <files>
    app/src/assets/scss/partials/_animations.scss
    app/src/assets/scss/_design-tokens.scss
  </files>
  <action>
    Create animation/transition tokens with WCAG 2.2 reduced-motion support:

    1. Create `partials/_animations.scss`:
       - --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1)
       - --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1)
       - --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1)

    2. Add @media (prefers-reduced-motion: reduce) block:
       - Set all transition durations to 0.01ms
       - Disable animations completely
       - This is NFR-03.6 compliance

    3. Add focus ring tokens:
       - --focus-ring-width: 0.25rem
       - --focus-ring-color: rgba(13, 71, 161, 0.25)
       - --focus-ring-offset: 2px

    4. Update _design-tokens.scss to import _animations.scss
  </action>
  <verify>
    - partials/_animations.scss exists with prefers-reduced-motion media query
    - Build succeeds: `npm run build --prefix app`
    - CSS contains @media (prefers-reduced-motion: reduce)
  </verify>
  <done>
    Transition tokens created with reduced-motion support (NFR-03.6 compliance)
  </done>
</task>

</tasks>

<verification>
Run comprehensive verification:

```bash
# Build succeeds
npm run build --prefix app

# Check CSS custom properties exist in output
grep -r "--medical-blue" app/dist/assets/*.css
grep -r "--shadow-" app/dist/assets/*.css
grep -r "prefers-reduced-motion" app/dist/assets/*.css

# Check SCSS syntax
npm run dev --prefix app &
sleep 3
kill %1
```
</verification>

<success_criteria>
- [ ] SCSS partials directory structure created
- [ ] Medical color palette defined (--medical-blue-*, --medical-teal-*)
- [ ] Shadow depth system defined (--shadow-xs through --shadow-xl)
- [ ] Spacing scale defined (--spacing-compact, --spacing-base, --spacing-comfortable)
- [ ] Transition tokens with prefers-reduced-motion support
- [ ] custom.scss follows correct Bootstrap import order
- [ ] Build succeeds without SCSS errors
- [ ] CSS custom properties visible in browser dev tools
</success_criteria>

<output>
After completion, create `.planning/phases/16-ui-ux-modernization/16-01-SUMMARY.md`
</output>
