---
phase: 13-mixin-composable-conversion
plan: 05
type: execute
wave: 4
depends_on: ["13-01", "13-02", "13-03", "13-04"]
files_modified:
  - app/src/components/tables/TablesGenes.vue
  - app/src/components/tables/TablesLogs.vue
  - app/src/components/tables/TablesEntities.vue
  - app/src/components/tables/TablesPhenotypes.vue
  - app/src/components/analyses/AnalysesTimePlot.vue
  - app/src/components/analyses/PubtatorNDDGenes.vue
  - app/src/components/analyses/PubtatorNDDTable.vue
  - app/src/components/analyses/AnalysesCurationComparisonsTable.vue
  - app/src/components/analyses/PublicationsNDDTimePlot.vue
  - app/src/components/analyses/AnalyseGeneClusters.vue
  - app/src/components/analyses/PublicationsNDDTable.vue
  - app/src/views/Home.vue
  - app/src/views/pages/Gene.vue
  - app/src/views/pages/Ontology.vue
  - app/src/views/User.vue
  - app/src/views/pages/Entity.vue
  - app/src/views/curate/ApproveUser.vue
  - app/src/views/curate/ModifyEntity.vue
  - app/src/views/tables/Panels.vue
  - app/src/views/curate/ApproveStatus.vue
  - app/src/views/review/Review.vue
  - app/src/views/curate/CreateEntity.vue
  - app/src/views/curate/ApproveReview.vue
autonomous: true

must_haves:
  truths:
    - "All table components use useTableData and useTableMethods composables"
    - "All components using multiple mixins are updated to use composables"
    - "No mixin imports remain in any components"
    - "Templates work without modification (same property names)"
  artifacts:
    - path: "app/src/components/tables/TablesGenes.vue"
      provides: "Genes table using composables"
      contains: "useTableData"
    - path: "app/src/views/Home.vue"
      provides: "Home page using composables"
      contains: "useColorAndSymbols"
  key_links:
    - from: "table components"
      to: "useTableData + useTableMethods"
      via: "setup() composition"
      pattern: "const.*=.*useTableData"
    - from: "multi-mixin components"
      to: "multiple composables"
      via: "setup() destructuring"
      pattern: "const \\{.*\\} = use"
---

<objective>
Update all remaining components to use composables instead of mixins.

Purpose: Complete the migration by updating all components that use multiple mixins (colorAndSymbolsMixin, textMixin, tableDataMixin, tableMethodsMixin, urlParsingMixin) to use the new composables. This is the largest migration batch.

Output: All 23+ remaining components fully migrated to composables
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-mixin-composable-conversion/13-CONTEXT.md
@.planning/phases/13-mixin-composable-conversion/13-RESEARCH.md

# Prior plan summaries
@.planning/phases/13-mixin-composable-conversion/13-01-SUMMARY.md
@.planning/phases/13-mixin-composable-conversion/13-02-SUMMARY.md
@.planning/phases/13-mixin-composable-conversion/13-03-SUMMARY.md
@.planning/phases/13-mixin-composable-conversion/13-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update table components (TablesGenes, TablesLogs, TablesEntities, TablesPhenotypes)</name>
  <files>
app/src/components/tables/TablesGenes.vue
app/src/components/tables/TablesLogs.vue
app/src/components/tables/TablesEntities.vue
app/src/components/tables/TablesPhenotypes.vue
  </files>
  <action>
These table components use the most mixins. Convert each one following this pattern:

For TablesGenes.vue (example - uses 6 mixins):
```javascript
// REMOVE these imports:
import toastMixin from '@/assets/js/mixins/toastMixin';
import urlParsingMixin from '@/assets/js/mixins/urlParsingMixin';
import colorAndSymbolsMixin from '@/assets/js/mixins/colorAndSymbolsMixin';
import textMixin from '@/assets/js/mixins/textMixin';
import tableMethodsMixin from '@/assets/js/mixins/tableMethodsMixin';
import tableDataMixin from '@/assets/js/mixins/tableDataMixin';

// REMOVE:
mixins: [toastMixin, urlParsingMixin, colorAndSymbolsMixin, textMixin, tableMethodsMixin, tableDataMixin],

// ADD these imports:
import { ref, watch, onMounted } from 'vue';
import {
  useToast,
  useUrlParsing,
  useColorAndSymbols,
  useText,
  useTableData,
  useTableMethods,
} from '@/composables';

// ADD setup() function:
setup(props) {
  // Independent composables
  const { makeToast } = useToast();
  const { filterObjToStr, filterStrToObj, sortStringToVariables } = useUrlParsing();
  const {
    stoplights_style, saved_style, ndd_icon, ndd_icon_style,
    // ... other needed style mappings
  } = useColorAndSymbols();
  const {
    ndd_icon_text, inheritance_short_text,
    // ... other needed text mappings
  } = useText();

  // Table state composable
  const tableData = useTableData({
    pageSize: props.pageSizeInput,
    sort: props.sortInput,
    pageAfter: props.pageAfterInput,
  });

  // Component-specific filter (defined here, not in composable)
  const filter = ref({
    any: { content: null, operator: 'any', join_char: ',' },
    // ... component-specific filter fields
  });

  // Table methods composable
  const tableMethods = useTableMethods(tableData, {
    filter,
    loadData: () => loadData(), // Will be defined in methods
    apiEndpoint: 'genes', // Component-specific
    axios: /* inject or import axios */,
  });

  // Return all needed properties for template and methods
  return {
    // From useToast
    makeToast,
    // From useUrlParsing
    filterObjToStr, filterStrToObj, sortStringToVariables,
    // From useColorAndSymbols
    stoplights_style, saved_style, ndd_icon, ndd_icon_style,
    // From useText
    ndd_icon_text, inheritance_short_text,
    // From useTableData (spread all)
    ...tableData,
    // From useTableMethods (spread all)
    ...tableMethods,
    // Component-specific
    filter,
  };
},
```

Key points:
1. Keep loadData and other component-specific methods in the component's methods option
2. The setup() returns all composable values so methods can access them via this
3. Spread tableData and tableMethods to expose all their returns
4. filter is component-specific, defined in setup() not composable

Repeat for TablesLogs, TablesEntities, TablesPhenotypes with their specific filter structures.
  </action>
  <verify>
For each table component:
- No mixin imports
- No mixins: [] array
- setup() returns all composable values
- Build succeeds: `cd app && npm run build`
  </verify>
  <done>All 4 main table components migrated to composables</done>
</task>

<task type="auto">
  <name>Task 2: Update analysis components with multiple mixins</name>
  <files>
app/src/components/analyses/AnalysesTimePlot.vue
app/src/components/analyses/PubtatorNDDGenes.vue
app/src/components/analyses/PubtatorNDDTable.vue
app/src/components/analyses/AnalysesCurationComparisonsTable.vue
app/src/components/analyses/PublicationsNDDTimePlot.vue
app/src/components/analyses/AnalyseGeneClusters.vue
app/src/components/analyses/PublicationsNDDTable.vue
  </files>
  <action>
Update analysis components that use multiple mixins:

Pattern (simpler than tables - usually just toast + colorAndSymbols or toast + text):

```javascript
// REMOVE mixin imports
// REMOVE mixins: [...]

// ADD:
import { useToast, useColorAndSymbols, useText } from '@/composables';

export default {
  setup() {
    const { makeToast } = useToast();
    const { stoplights_style, /* ... needed styles */ } = useColorAndSymbols();
    const { ndd_icon_text, /* ... needed text */ } = useText();

    return {
      makeToast,
      stoplights_style,
      ndd_icon_text,
      // ... all destructured values
    };
  },
  // ... rest of component unchanged
};
```

Components in this batch:
- AnalysesTimePlot.vue (toast + text)
- PubtatorNDDGenes.vue (toast + urlParsing + colorAndSymbols + text + tableMethods + tableData)
- PubtatorNDDTable.vue (toast + urlParsing + colorAndSymbols + text + tableMethods + tableData)
- AnalysesCurationComparisonsTable.vue (toast + urlParsing + colorAndSymbols)
- PublicationsNDDTimePlot.vue (toast + text)
- AnalyseGeneClusters.vue (toast + colorAndSymbols)
- PublicationsNDDTable.vue (toast + urlParsing + colorAndSymbols + text + tableMethods + tableData)

For table-like components (PubtatorNDDGenes, PubtatorNDDTable, PublicationsNDDTable), follow the same pattern as Task 1.
  </action>
  <verify>
For each component:
- No mixin imports remain
- setup() provides all needed properties
- Build succeeds
  </verify>
  <done>Analysis components with multiple mixins migrated</done>
</task>

<task type="auto">
  <name>Task 3: Update view components with multiple mixins</name>
  <files>
app/src/views/Home.vue
app/src/views/pages/Gene.vue
app/src/views/pages/Ontology.vue
app/src/views/User.vue
app/src/views/pages/Entity.vue
app/src/views/curate/ApproveUser.vue
app/src/views/curate/ModifyEntity.vue
app/src/views/tables/Panels.vue
app/src/views/curate/ApproveStatus.vue
app/src/views/review/Review.vue
app/src/views/curate/CreateEntity.vue
app/src/views/curate/ApproveReview.vue
  </files>
  <action>
Update view components that use multiple mixins:

Same pattern - remove mixins, add setup() with composables:

```javascript
import { useToast, useColorAndSymbols, useText } from '@/composables';

export default {
  setup() {
    const { makeToast } = useToast();
    const { stoplights_style, user_style, /* ... */ } = useColorAndSymbols();
    const { modifier_text, /* ... */ } = useText();

    return {
      makeToast,
      stoplights_style,
      user_style,
      modifier_text,
      // ... all needed values
    };
  },
  // ... rest unchanged
};
```

Components in this batch:
- Home.vue (toast + colorAndSymbols + text)
- Gene.vue (toast + colorAndSymbols)
- Ontology.vue (toast + colorAndSymbols)
- User.vue (toast + colorAndSymbols)
- Entity.vue (toast + colorAndSymbols + text)
- ApproveUser.vue (toast + colorAndSymbols)
- ModifyEntity.vue (toast + colorAndSymbols)
- Panels.vue (toast only - but check if already done in 13-02)
- ApproveStatus.vue (toast + colorAndSymbols + text)
- Review.vue (toast + colorAndSymbols + text)
- CreateEntity.vue (toast + colorAndSymbols + text)
- ApproveReview.vue (toast + colorAndSymbols + text)

Note: Only update what's needed. If template uses stoplights_style, include it. Don't include unused mappings.
  </action>
  <verify>
For each component:
- No mixin imports remain
- setup() provides exactly what template/methods need
- Build succeeds: `cd app && npm run build`
  </verify>
  <done>All view components with multiple mixins migrated</done>
</task>

</tasks>

<verification>
1. No mixin imports in any components:
```bash
grep -r "from '@/assets/js/mixins" app/src --include="*.vue" | wc -l
# Should be 0
```

2. Build succeeds: `cd app && npm run build`

3. Functional verification:
   - Navigate to Genes table page
   - Verify sorting works
   - Verify filtering works
   - Verify pagination works
   - Verify style colors appear correctly
</verification>

<success_criteria>
- All 23+ remaining components migrated to composables
- No mixin imports in any Vue components
- Templates unchanged (same property names)
- Build succeeds with no errors
- Tables, forms, and styles work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/13-mixin-composable-conversion/13-05-SUMMARY.md`
</output>
