---
phase: 30-statistics-dashboard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/package.json
  - app/src/views/admin/components/charts/EntityTrendChart.vue
  - app/src/views/admin/components/charts/ContributorBarChart.vue
  - app/src/views/admin/components/statistics/StatCard.vue
autonomous: true

must_haves:
  truths:
    - "EntityTrendChart renders a line chart with smooth Bezier curves"
    - "ContributorBarChart renders a horizontal bar chart for leaderboard"
    - "StatCard displays value with optional trend arrow and percentage"
    - "Charts use Paul Tol Muted palette for scientific credibility"
  artifacts:
    - path: "app/src/views/admin/components/charts/EntityTrendChart.vue"
      provides: "Line chart for entity submissions over time"
      exports: ["default"]
    - path: "app/src/views/admin/components/charts/ContributorBarChart.vue"
      provides: "Horizontal bar chart for contributor leaderboard"
      exports: ["default"]
    - path: "app/src/views/admin/components/statistics/StatCard.vue"
      provides: "KPI card with trend indicator"
      exports: ["default"]
  key_links:
    - from: "EntityTrendChart.vue"
      to: "vue-chartjs Line"
      via: "import { Line } from 'vue-chartjs'"
      pattern: "import.*Line.*vue-chartjs"
    - from: "ContributorBarChart.vue"
      to: "vue-chartjs Bar"
      via: "import { Bar } from 'vue-chartjs'"
      pattern: "import.*Bar.*vue-chartjs"
---

<objective>
Install Chart.js dependencies and create reusable chart components for the statistics dashboard.

Purpose: Establish the visualization foundation with tree-shaken Chart.js registration and colorblind-safe palettes, following research findings.
Output: Three components ready for integration into AdminStatistics.vue
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-statistics-dashboard/30-CONTEXT.md
@.planning/phases/30-statistics-dashboard/30-RESEARCH.md
@app/src/views/admin/AdminStatistics.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Chart.js dependencies</name>
  <files>app/package.json</files>
  <action>
Install chart.js and vue-chartjs:
```bash
cd app && npm install chart.js vue-chartjs
```

Verify both packages are added to dependencies (chart.js is a peerDependency of vue-chartjs).
  </action>
  <verify>`npm list chart.js vue-chartjs` shows both packages installed</verify>
  <done>chart.js ^4.4.x and vue-chartjs ^5.3.x in app/package.json dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create chart and statistics components</name>
  <files>
    app/src/views/admin/components/charts/EntityTrendChart.vue
    app/src/views/admin/components/charts/ContributorBarChart.vue
    app/src/views/admin/components/statistics/StatCard.vue
  </files>
  <action>
Create directory structure:
- `app/src/views/admin/components/charts/`
- `app/src/views/admin/components/statistics/`

**EntityTrendChart.vue** - Line chart component:
- Use Composition API with TypeScript
- Tree-shaken Chart.js imports (CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler)
- Props: `entityData: Array<{ date: string; count: number }>`, `loading: boolean`, `showMovingAverage: boolean`
- Implement `calculateSMA(data, period)` utility for 3-period moving average
- Options: `maintainAspectRatio: false`, `tension: 0.4` for smooth curves
- Paul Tol Muted palette: primary `#6699CC`, secondary `#004488` for MA line
- Minimal tooltip: just `${value} entities`
- Wrap in relative-positioned div with `height: 400px`
- Show BSpinner centered when loading

**ContributorBarChart.vue** - Horizontal bar chart:
- Tree-shaken Chart.js imports (CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend)
- Props: `contributors: Array<{ user_name: string; entity_count: number }>`, `loading: boolean`
- Options: `indexAxis: 'y'` for horizontal bars, `maintainAspectRatio: false`
- Paul Tol Muted blue `#6699CC` for bars
- Minimal tooltip: `${value} entities`
- Height: 350px wrapper

**StatCard.vue** - KPI card component:
- Props: `label: string`, `value: number`, `delta?: number`, `context?: string`, `unit?: string`
- Okabe-Ito colorblind-safe trend colors: up `#009E73`, down `#D55E00`
- Trend icons: up arrow, down arrow, neutral arrow
- Format value with `toLocaleString()` for readability
- Left border accent (`border-left: 4px solid #6699CC`)
- Display delta as `{icon} {abs(delta)}%` with appropriate color
  </action>
  <verify>
All three component files exist with correct imports:
- `grep -l "vue-chartjs" app/src/views/admin/components/charts/*.vue`
- `grep "maintainAspectRatio: false" app/src/views/admin/components/charts/*.vue`
  </verify>
  <done>
- EntityTrendChart.vue renders line chart with moving average option
- ContributorBarChart.vue renders horizontal bar chart
- StatCard.vue displays KPI with trend indicator
  </done>
</task>

</tasks>

<verification>
1. `cd app && npm list chart.js vue-chartjs` shows correct versions
2. All three components exist in correct directories
3. Components use tree-shaken imports (no `registerables`)
4. Components have TypeScript type definitions for props
5. Both chart components set `maintainAspectRatio: false`
</verification>

<success_criteria>
- Chart.js v4.4+ and vue-chartjs v5.3+ installed
- EntityTrendChart.vue with line chart, MA overlay, loading state
- ContributorBarChart.vue with horizontal bars, loading state
- StatCard.vue with trend arrows and colorblind-safe colors
- All components use Composition API + TypeScript
</success_criteria>

<output>
After completion, create `.planning/phases/30-statistics-dashboard/30-01-SUMMARY.md`
</output>
