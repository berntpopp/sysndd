---
phase: 14-typescript-introduction
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/package.json
  - app/tsconfig.json
  - app/src/env.d.ts
  - app/src/main.ts
  - app/vite.config.ts
autonomous: true

must_haves:
  truths:
    - "TypeScript compiles without errors"
    - "Vite dev server starts with TypeScript support"
    - "Path aliases (@/) resolve correctly in TypeScript"
    - "Environment variables have type definitions"
  artifacts:
    - path: "app/tsconfig.json"
      provides: "TypeScript configuration"
      contains: "@vue/tsconfig"
    - path: "app/src/env.d.ts"
      provides: "Environment variable types"
      contains: "ImportMetaEnv"
    - path: "app/src/main.ts"
      provides: "TypeScript entry point"
      min_lines: 80
    - path: "app/vite.config.ts"
      provides: "TypeScript Vite config"
      contains: "defineConfig"
  key_links:
    - from: "app/tsconfig.json"
      to: "app/vite.config.ts"
      via: "path alias alignment"
      pattern: '"@/\\*"'
    - from: "app/src/main.ts"
      to: "vue"
      via: "typed import"
      pattern: "import.*from 'vue'"
---

<objective>
Install TypeScript infrastructure and convert entry point files

Purpose: Enable TypeScript compilation for the SysNDD frontend, establishing the foundation for type-safe development. This is the first step in the TypeScript introduction phase.

Output: TypeScript configured with Vite, main.ts entry point working, environment variables typed
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-typescript-introduction/14-CONTEXT.md
@.planning/phases/14-typescript-introduction/14-RESEARCH.md
@app/package.json
@app/vite.config.js
@app/src/main.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install TypeScript dependencies</name>
  <files>app/package.json</files>
  <action>
Install TypeScript core packages:

```bash
cd app && npm install --save-dev typescript@^5.7.0 vue-tsc@^3.2.2 @vue/tsconfig @types/node
```

After installation, update package.json scripts to add type checking:
- Add "type-check": "vue-tsc --noEmit"
- Update "build:vite" to include type check: "vue-tsc --noEmit && vite build"

Do NOT remove existing scripts. Add alongside them.
  </action>
  <verify>
```bash
cd app && npm list typescript vue-tsc @vue/tsconfig
```
All packages should be listed with correct versions.
  </verify>
  <done>TypeScript 5.7+, vue-tsc 3.2.2+, @vue/tsconfig installed; type-check script in package.json</done>
</task>

<task type="auto">
  <name>Task 2: Create TypeScript configuration</name>
  <files>app/tsconfig.json, app/src/env.d.ts</files>
  <action>
Create tsconfig.json in app/ directory with these specific settings (from RESEARCH.md - single tsconfig approach):

```json
{
  "extends": "@vue/tsconfig/tsconfig.dom.json",
  "include": ["src/**/*", "src/**/*.vue", "vite.config.ts"],
  "compilerOptions": {
    "strict": false,
    "noImplicitAny": false,
    "allowJs": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "types": ["node", "vite/client"]
  }
}
```

Key decisions:
- strict: false - relaxed mode per user decision
- allowJs: true - enables gradual migration (.js and .ts coexist)
- Single tsconfig (no project references) - user preference
- Path aliases match Vite config (@/ -> ./src/*)

Create src/env.d.ts for environment variable types:

```typescript
/// <reference types="vite/client" />

interface ImportMetaEnv {
  readonly VITE_API_URL: string;
  readonly VITE_BASE_URL?: string;
  readonly BASE_URL: string;
  readonly MODE: string;
  readonly DEV: boolean;
  readonly PROD: boolean;
  readonly SSR: boolean;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```

This provides type safety for import.meta.env usage throughout the app.
  </action>
  <verify>
```bash
cd app && cat tsconfig.json && cat src/env.d.ts
```
Both files should exist with correct content.
  </verify>
  <done>tsconfig.json with relaxed strict mode, env.d.ts with typed environment variables</done>
</task>

<task type="auto">
  <name>Task 3: Convert entry point files to TypeScript</name>
  <files>app/src/main.ts, app/vite.config.ts</files>
  <action>
Rename and convert main.js to main.ts:

```bash
cd app && git mv src/main.js src/main.ts
```

Update main.ts with type annotations:
- Add type import: `import type { App as VueApp } from 'vue';`
- Type the app instance: `const app: VueApp = createApp(App);`
- Keep all existing functionality exactly the same
- Add minimal type annotations (not full strict typing yet)

Example type annotations to add:
```typescript
import type { App as VueApp } from 'vue';
// ... existing imports ...

const pinia = createPinia();
const head = createHead();
const app: VueApp = createApp(App);
```

Rename and convert vite.config.js to vite.config.ts:

```bash
cd app && git mv vite.config.js vite.config.ts
```

The vite.config.ts content remains largely the same - Vite's defineConfig already provides type inference. No additional changes needed beyond the rename.

After conversion, verify TypeScript compiles:
```bash
cd app && npx vue-tsc --noEmit
```

Expected: Some errors from unconverted .js files, but main.ts and vite.config.ts should compile clean. Warnings are OK during migration.
  </action>
  <verify>
```bash
cd app && npm run dev -- --port 5173 &
sleep 5
curl -s http://localhost:5173 | head -20
pkill -f "vite"
```
Vite dev server should start and serve the app.
  </verify>
  <done>main.ts and vite.config.ts exist and compile; Vite dev server starts successfully</done>
</task>

</tasks>

<verification>
1. TypeScript packages installed:
   ```bash
   cd app && npm list typescript vue-tsc @vue/tsconfig
   ```

2. TypeScript configuration valid:
   ```bash
   cd app && npx tsc --showConfig
   ```

3. Vite starts with TypeScript:
   ```bash
   cd app && npm run dev
   ```
   Dev server should start on port 5173

4. Type check runs (errors expected from unconverted files):
   ```bash
   cd app && npm run type-check
   ```
</verification>

<success_criteria>
- TypeScript 5.7+ installed
- vue-tsc 3.2.2+ installed
- tsconfig.json exists with strict: false
- env.d.ts provides ImportMetaEnv types
- main.ts compiles without errors
- vite.config.ts compiles without errors
- Vite dev server starts successfully
- Path aliases (@/) resolve correctly
</success_criteria>

<output>
After completion, create `.planning/phases/14-typescript-introduction/14-01-SUMMARY.md`
</output>
