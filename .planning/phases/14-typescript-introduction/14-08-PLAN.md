---
phase: 14-typescript-introduction
plan: 08
type: execute
wave: 4
depends_on: ["14-07"]
files_modified:
  - app/src/main.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "vue-tsc --noEmit exits with code 0"
    - "Production build (npm run build:vite) succeeds"
  artifacts:
    - path: "app/src/main.ts"
      provides: "Type-safe Bootstrap-Vue-Next component registration"
      contains: "BFormDatalist"
  key_links:
    - from: "app/src/main.ts"
      to: "bootstrap-vue-next"
      via: "Global component registration"
      pattern: "app\\.component\\(name, component\\)"
---

<objective>
Fix TypeScript compilation error in main.ts caused by BFormDatalist type incompatibility.

Purpose: Enable production builds by resolving the vue-tsc type error that blocks `npm run build:vite`.

Output: main.ts compiles cleanly with vue-tsc --noEmit returning exit code 0.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-typescript-introduction/14-VERIFICATION.md

# Source files
@app/src/main.ts
@app/src/bootstrap-vue-next-components.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Diagnose and fix BFormDatalist type error</name>
  <files>app/src/main.ts</files>
  <action>
The type error at line 91 occurs because BFormDatalist has generic slot types that don't match vue-tsc's expectations during global component registration.

**Investigation steps:**
1. Run `npx vue-tsc --noEmit` to confirm the exact error
2. Check Bootstrap-Vue-Next version and type definitions

**Fix approach - choose one:**

**Option A (Preferred): Type assertion for component registration**
Cast the component to the expected type during registration:

```typescript
import type { Component } from 'vue';

// Register all Bootstrap-Vue-Next components globally
Object.entries(BvnComponents).forEach(([name, component]) => {
  app.component(name, component as Component);
});
```

**Option B: Suppress with @ts-expect-error**
If Option A doesn't work, add suppression comment with explanation:

```typescript
// Register all Bootstrap-Vue-Next components globally
Object.entries(BvnComponents).forEach(([name, component]) => {
  // @ts-expect-error BFormDatalist has generic slot types incompatible with Vue's app.component()
  // This is a Bootstrap-Vue-Next type definition issue, component works correctly at runtime
  app.component(name, component);
});
```

**Why not @ts-ignore:** @ts-expect-error is preferred because it will error if the underlying issue is fixed, prompting removal of the workaround.

**Do NOT:**
- Remove BFormDatalist from registration (it may be used in components)
- Change Bootstrap-Vue-Next version
- Disable type checking for the entire file
  </action>
  <verify>
Run `cd /home/bernt-popp/development/sysndd/app && npx vue-tsc --noEmit && echo "SUCCESS: No type errors"` - should exit with code 0 and print success message.
  </verify>
  <done>
vue-tsc --noEmit exits with code 0, no type errors in main.ts.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify production build succeeds</name>
  <files>app/src/main.ts</files>
  <action>
Verify the fix doesn't break the production build:

1. Run `npm run build:vite` which executes `vue-tsc --noEmit && vite build`
2. Confirm build completes successfully
3. Check that dist/ folder is populated with built assets

If build fails for reasons OTHER than the type fix:
- Document the separate issue
- Do not attempt to fix unrelated build issues in this task
  </action>
  <verify>
Run `cd /home/bernt-popp/development/sysndd/app && npm run build:vite` - should complete without errors.
  </verify>
  <done>
Production build succeeds: vue-tsc passes, vite build creates dist/ with assets.
  </done>
</task>

</tasks>

<verification>
- [ ] `vue-tsc --noEmit` exits with code 0
- [ ] `npm run build:vite` succeeds
- [ ] No new ESLint warnings introduced
- [ ] Dev server still works (`npm run dev`)
</verification>

<success_criteria>
- TypeScript compilation error in main.ts resolved
- Production build pipeline unblocked
- No runtime behavior changes (fix is type-level only)
</success_criteria>

<output>
After completion, create `.planning/phases/14-typescript-introduction/14-08-SUMMARY.md`
</output>
