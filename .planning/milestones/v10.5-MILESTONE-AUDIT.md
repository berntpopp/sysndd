---
milestone: v10.5
audited: 2026-02-09
status: tech_debt
scores:
  requirements: 21/27
  phases: 3/3
  integration: 15/15
  flows: 4/4
gaps:
  requirements:
    - "INTEG-01: Admin endpoint for suffix-gene misalignment detection (Phase 83 not started)"
    - "INTEG-02: Fixability classification auto-fixable vs needs-curator (Phase 83 not started)"
    - "INTEG-03: ManageEntityIntegrity.vue admin view (Phase 83 not started)"
    - "INTEG-04: Orphaned pointer entity 4269 surfaced (Phase 83 not started)"
    - "INTEG-05: Compatibility rows for broken inactive entity FKs (Phase 83 not started)"
    - "INTEG-06: Migration script with stored procedure guards (Phase 83 not started)"
  integration: []
  flows: []
tech_debt:
  - phase: 80-foundation-fixes
    items:
      - "Pre-existing: Stats API type=all returns 500 (object 'inheritance' not found)"
  - phase: 81-adminstatistics-sub-bugs
    items:
      - "clampPositive() exported but not yet used (defensive utility for future use)"
      - "AbortController slow-network behavior not E2E testable in dev (verified via code inspection)"
  - phase: 82-pubtator-backend-fix
    items:
      - "Pre-existing: 70 TypeScript errors in unrelated .spec.ts files"
      - "Historical backfill for ~2,900 PMIDs missing annotations (deferred to BACK-02)"
---

# Milestone v10.5 — Audit Report

**Milestone:** v10.5 Bug Fixes & Data Integrity
**Audited:** 2026-02-09
**Phases:** 80 (Foundation Fixes), 81 (AdminStatistics Sub-Bugs), 82 (PubTator Backend Fix)

## Executive Summary

Milestone v10.5 delivered **21 of 27** requirements across 3 phases. All 3 phases passed verification. Cross-phase integration is excellent with zero broken connections. The 6 unsatisfied requirements all belong to **Phase 83 (Entity Data Integrity Audit)**, which was planned in the roadmap but never started — these are the INTEG-01 through INTEG-06 requirements for GitHub issue #167.

All bug fixes (#173, #172, #171, #170, #169) are complete. The remaining work (#167) is a new feature (admin entity integrity audit UI), not a bug fix.

## Phase Verification Summary

| Phase | Name | Status | Score | Requirements |
|-------|------|--------|-------|--------------|
| 80 | Foundation Fixes | ✓ PASSED | 14/14 | DISP-01 to DISP-05, INFRA-01, INFRA-02 |
| 81 | AdminStatistics Sub-Bugs | ✓ PASSED | 7/7 | STAT-01 to STAT-08, TEST-03 |
| 82 | PubTator Backend Fix | ✓ PASSED | 4/4 | API-01, API-02, API-03 |

**All 3 phases verified with 100% scores. No unverified phases.**

## Requirements Coverage

### Satisfied (21/27)

| Requirement | Phase | Description | Status |
|-------------|-------|-------------|--------|
| DISP-01 | 80 | Per-source category values (no cross-database max) | ✓ Satisfied |
| DISP-02 | 80 | Shared `normalize_comparison_categories()` helper | ✓ Satisfied |
| DISP-03 | 80 | `definitive_only` filter applies per-source | ✓ Satisfied |
| DISP-04 | 80 | `mergeGroupedCumulativeSeries()` for sparse trend data | ✓ Satisfied |
| DISP-05 | 80 | Monotonically non-decreasing global trend total | ✓ Satisfied |
| INFRA-01 | 80 | Traefik Host() matcher for TLS cert selection | ✓ Satisfied |
| INFRA-02 | 80 | No "No domain found" Traefik startup warnings | ✓ Satisfied |
| STAT-01 | 81 | Cross-pathway `sync_rereview_approval()` hook | ✓ Satisfied |
| STAT-02 | 81 | Re-review endpoint delegates to repository functions | ✓ Satisfied |
| STAT-03 | 81 | Three-segment leaderboard chart | ✓ Satisfied |
| STAT-04 | 81 | Dynamic percentage denominator from COUNT query | ✓ Satisfied |
| STAT-05 | 81 | `totalEntities` computed inside `fetchTrendData()` | ✓ Satisfied |
| STAT-06 | 81 | `inclusiveDayCount()` and `previousPeriod()` date utilities | ✓ Satisfied |
| STAT-07 | 81 | `safeArray()` and `clampPositive()` defensive utilities | ✓ Satisfied |
| STAT-08 | 81 | AbortController for request cancellation | ✓ Satisfied |
| TEST-03 | 81 | Integration test for re-review approval sync | ✓ Satisfied |
| API-01 | 82 | LEFT JOIN query for missing-only annotation fetching | ✓ Satisfied |
| API-02 | 82 | INSERT IGNORE for batch deduplication | ✓ Satisfied |
| API-03 | 82 | 350ms rate limiting per NCBI API call | ✓ Satisfied |
| TEST-01 (P80+P82) | Cross-cutting | R unit tests for category normalization, PubTator | ✓ Satisfied |
| TEST-02 (P80+P81) | Cross-cutting | TypeScript unit tests for time-series, date, API utils | ✓ Satisfied |

### Unsatisfied (6/27) — Phase 83 Not Started

| Requirement | Phase | Description | Status |
|-------------|-------|-------------|--------|
| INTEG-01 | 83 | Admin endpoint for suffix-gene misalignment detection | ✗ Not started |
| INTEG-02 | 83 | Fixability classification: auto-fixable vs needs-curator | ✗ Not started |
| INTEG-03 | 83 | ManageEntityIntegrity.vue admin view | ✗ Not started |
| INTEG-04 | 83 | Orphaned pointer entity 4269 surfaced | ✗ Not started |
| INTEG-05 | 83 | Compatibility rows for broken inactive entity FKs | ✗ Not started |
| INTEG-06 | 83 | Migration script with stored procedure guards | ✗ Not started |

**Note:** All 6 unsatisfied requirements belong to GitHub issue #167 (admin entity data integrity audit). This is a new feature, not a bug fix. The ROADMAP.md shows only Phases 80-82, meaning Phase 83 was planned in requirements but not added to the roadmap execution order.

## Cross-Phase Integration

### Wiring Verification

| Check | Count | Status |
|-------|-------|--------|
| Exports checked | 15 | ✓ All connected |
| API routes verified | 6 | ✓ All consumed |
| Orphaned exports | 0 | ✓ None |
| Missing connections | 0 | ✓ None |

### Shared File Consistency

| File | Phases | Conflicts |
|------|--------|-----------|
| AdminStatistics.vue | 80, 81, 81-03 | None — composable refactor isolates changes |
| statistics_endpoints.R | 80, 81 | None — different endpoints modified |
| timeSeriesUtils.ts | 80, 81-03 | None — additive (new function in 81-03) |
| review-repository.R | 81, 82 | None — sync call inside corrected transaction |
| status-repository.R | 81, 82 | None — sync call inside corrected transaction |

### E2E User Flows

| Flow | Status | Verification |
|------|--------|-------------|
| CurationComparisons browsing + Definitive filter | ✓ Complete | Code + API + browser manual test |
| AdminStatistics dashboard interaction | ✓ Complete | Composable wiring + E2E browser test |
| Curator approve review → leaderboard update | ✓ Complete | E2E browser test (2 users) |
| PubTator annotation update | ✓ Complete | Code inspection + unit tests |

## Unplanned Work (Discovered During Execution)

Phase 82 discovered significant unplanned issues during E2E testing:

| Discovery | Impact | Resolution |
|-----------|--------|------------|
| Migration 017: missing `gene_symbols` column | Blocked PubTator storage | Idempotent migration added |
| 18 broken `db_with_transaction` callers | Zero atomicity in 18 call sites | All 18 fixed to function pattern |
| BioCJSON parsing pipeline (3 cascading bugs) | 72% annotation loss | Complete rewrite with `fromJSON()` |
| Static analysis test for transaction patterns | Prevent future regression | `test-unit-transaction-patterns.R` added |

These were substantial fixes that went well beyond the original plan scope, but significantly improved data integrity.

## Tech Debt Summary

| Phase | Item | Severity |
|-------|------|----------|
| 80 | Pre-existing: Stats API `type=all` returns 500 | Low (non-default param) |
| 81 | `clampPositive()` exported but unused | Negligible (available for future) |
| 82 | Pre-existing: 70 TS errors in unrelated .spec.ts files | Low (pre-existing) |
| 82 | PubTator historical backfill ~2,900 PMIDs (BACK-02) | Medium (deferred to v2) |

**Total: 4 items across 3 phases. No blockers.**

## Test Coverage Delivered

| Phase | R Tests | TS Tests | Integration | E2E |
|-------|---------|----------|-------------|-----|
| 80 | 37 (category normalization) | 9 (timeSeriesUtils) | — | — |
| 81 | — | 26 (dateUtils + apiUtils) | 5 (re-review sync) | 2 (browser) |
| 82 | 8 (pubtator functions) | — | — | — |
| 82 (unplanned) | Static analysis guard | — | — | — |

**Total: 45 R tests + 35 TS tests + 5 integration tests + 2 E2E browser tests**

## Conclusion

v10.5 successfully fixed all 5 targeted bugs (#173, #172, #171, #170, #169) with thorough verification and excellent cross-phase integration. The 6 unsatisfied requirements (INTEG-01 through INTEG-06) belong to Phase 83 which was included in REQUIREMENTS.md but not in the execution scope (ROADMAP.md shows Phases 80-82 only).

**Decision needed:** Complete milestone with Phase 83 deferred to v10.6, or plan Phase 83 before completing.

---
*Audited: 2026-02-09*
*Auditor: Claude (gsd audit-milestone orchestrator + gsd-integration-checker)*
